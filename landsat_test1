/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var roi = /* color: #ffc82d */ee.Geometry.Polygon(
        [[[93.27120009106288, 24.194531859036044],
          [94.0604517305833, 23.994345315136123],
          [94.23571934476857, 24.7132120856161],
          [93.44672683158653, 24.922026164577357]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
var dataset = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')
    .filterDate('2021-01-01', '2021-12-31')
    .filterBounds(roi);
    // .sort('CLOUD_COVER')
    // .first();
    

    
// Applies scaling factors.
function applyScaleFactors(image) {
  var opticalBands = image.select('SR_B.').multiply(0.0000275).add(-0.2);
  var thermalBands = image.select('ST_B.*').multiply(0.00341802).add(149.0);
  return image.addBands(opticalBands, null, true)
              .addBands(thermalBands, null, true);
}

dataset = dataset.map(applyScaleFactors);

print("No. of images in collection: ", dataset.size())

var image = dataset.first();
//var image = dataset.sort('CLOUD_COVER').first();

var visualization = {
  bands: ['SR_B4', 'SR_B3', 'SR_B2'],
  min: 0.0,
  max: 0.3,
  gamma:1.4
};

// Map.setCenter(-114.2579, 38.9275, 8);

// Map.addLayer(image.clip(roi2), visualization, 'Manipur_Landsat');

Map.addLayer(dataset, visualization, 'Manipur_Landsat');

Map.centerObject(roi, 7);

Export.image.toDrive({
  image:image,
  description: 'Landsat_Manipur',
  scale: 30,
  region: roi,
  maxPixels: 1e13
})